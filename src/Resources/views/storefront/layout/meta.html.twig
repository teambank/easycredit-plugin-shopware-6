{% sw_extends '@Storefront/storefront/layout/meta.html.twig' %}

{% block layout_head_meta_tags_general %}
    {{ parent() }}

    {# @var easycredit #}
    {% set easycredit = page.extensions.easycredit %}

    {% set easycreditConfig = {} %}
    {% if easycredit.apiKey %}
    {% set easycreditConfig = easycreditConfig|merge({'api-key': easycredit.apiKey}) %}
    {% endif %}

    {% if easycredit.widgetSelector %}
    {% set easycreditConfig = easycreditConfig|merge({'widget-selector': easycredit.widgetSelector}) %}
    {% endif %}

    {% if easycredit.amount %}
    {% set easycreditConfig = easycreditConfig|merge({'amount': easycredit.amount}) %}
    {% endif %}

    {% if easycredit.disableFlexprice is not null %}
    {% set easycreditConfig = easycreditConfig|merge({'disable-flexprice': easycredit.disableFlexprice ? true : false}) %}
    {% endif %}

    {% if easycredit.paymentTypes %}
    {% set easycreditConfig = easycreditConfig|merge({'payment-types': easycredit.paymentTypes}) %}
    {% endif %}

    {% if easycreditConfig is not empty %}
    <script class="easycredit-config" type="application/json">{{ easycreditConfig|json_encode|raw }}</script>
    {% endif %}

{% endblock %}

{% block layout_head_javascript_router %}
    {{ parent() }}
    <script>
    if (typeof window.router === 'object') {
        window.router['frontend.easycredit.express'] = '{{ path('frontend.easycredit.express') }}';
    }
    </script>
{% endblock %}

{# >= SW 6.5 #}
{% block layout_head_javascript_hmr_mode %}
    {{ parent() }}

    {% if page.extensions.easycredit %}
    <script type="module" src="https://ratenkauf.easycredit.de/api/resource/webcomponents/v3/easycredit-components/easycredit-components.esm.js" defer></script>
    {% endif %}

{% endblock %}
