(()=>{var u=class{register(r,e,t=document,i={}){window.addEventListener("DOMContentLoaded",a=>{let s=document.querySelector(t);s&&new e(s).init()})}};var n=class{constructor(r,e={},t=!1){this.el=r}init(){throw new Error('The "init" method for the plugin is not defined.')}};var d=class extends n{init(){function r(e,t){var i=document.createElement("input");return i.setAttribute("type","hidden"),i.setAttribute("name",`easycredit[${e}]`),i.setAttribute("value",t),i}document.querySelector("easycredit-checkout")?.addEventListener("submit",e=>{var t=document.getElementById("changePaymentForm");return t.append(r("submit","1")),t.append(r("number-of-installments",e.detail.numberOfInstallments)),t.append(r("agreement-checked",e.detail.privacyCheckboxChecked)),t.submit(),!1})}};var c=class extends n{init(){this.el.addEventListener("submit",()=>{var r;if(r=this.replicateBuyForm()){r.submit();return}if(document.querySelector(".is-ctl-checkout.is-act-cartpage")){window.location.href="/easycredit/express";return}alert("Der easycredit-Ratenkauf konnte nicht gestartet werden.")})}replicateBuyForm(){let r=document.getElementById("productDetailPageBuyProductForm");if(!r)return!1;var e=document.createElement("form");e.setAttribute("action",r.getAttribute("action")),e.setAttribute("method","post"),e.style.display="none";var t=new FormData(r);t.set("redirectTo","frontend.easycredit.express"),t.set("easycredit-express","1");for(var i of t.keys()){let a=document.createElement("input");a.setAttribute("name",i),a.setAttribute("value",t.get(i)),e.append(a)}return document.querySelector("body").append(e),e}};var l=class extends n{init(){this.initWidget()}initWidget(){let r=this.getMeta("widget-selector");if(r===null||this.getMeta("api-key")===null)return;this.el=document.querySelector(r);let e=this.getMeta("amount");if(e===null||isNaN(e)){let i=this.el.parentNode;e=i&&i.querySelector("[itemprop=price]")?i.querySelector("[itemprop=price]").content:null}if(e===null||isNaN(e))return;let t=document.createElement("easycredit-widget");t.setAttribute("webshop-id",this.getMeta("api-key")),t.setAttribute("amount",this.getMeta("amount")),this.el.appendChild(t)}getMeta(r){let e=document.querySelector("meta[name=easycredit-"+r+"]");return e===null?null:e.content}};var m=class extends n{init(){this.initMarketing()}initMarketing(){if(this.body=document.querySelector("body"),this.bar=document.querySelector("easycredit-box-top"),this.bar&&this.body.classList.add("easycredit-box-top"),this.card=document.querySelector(".easycredit-box-listing"),this.card){var r=s=>[...s.parentElement.children].filter(f=>f!=s),e=r(this.card),t=this.card.querySelector("easycredit-box-listing").getAttribute("position"),i=typeof t===void 0?null:Number(t-1),a=typeof t===void 0?null:Number(t-2);!t||i<=0||(a in e?e[a].after(this.card):this.card.parentElement.append(this.card))}}};var p=new u;p.register("EasyCreditRatenkaufCheckout",d,".is-ctl-checkout.is-act-confirmpage");p.register("EasyCreditRatenkaufCheckoutExpress",c,"easycredit-express-button");p.register("EasyCreditRatenkaufWidget",l,"body");p.register("EasyCreditRatenkaufMarketing",m,"body");})();
